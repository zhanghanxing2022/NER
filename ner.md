# 隐马尔可夫模型（HMM）命名实体识别（NER）报告

## 简介

本文档概述了使用隐马尔可夫模型（HMM）进行命名实体识别（NER）的实现，涉及英语和中文两种语言。HMM在提供的数据集上进行了训练和评估，并进行了实验以分析不同参数的影响。

## 模型参数

### 初始概率矩阵（π）

初始概率矩阵，表示为π，表示每个标签在句子开头的概率。它根据在训练数据中句子开头的每个标签的频率进行初始化。

### 转移概率矩阵（A）

转移概率矩阵，表示为A，捕捉从一个标签转移到另一个标签的概率。它根据训练数据中标签之间的转移频率计算而得。

### 观测概率矩阵（B）

观测概率矩阵，表示为B，建模了在给定标签的情况下观察到一个词的概率。它根据训练数据中与每个标签相关联的单词的频率计算而得。

### 平滑技术

为了解决词汇外（OOV）问题，引入了在构建词汇表时的最小频率阈值（`min_freq`）。频率低于此阈值的单词被视为 '<unk>'（未知）。

## 数据和实验

### 训练数据

训练数据使用`get_train_data`函数获取，该函数根据选择的语言（英语/中文）不同而变化。该数据集用于估计初始、转移和观测概率。

### 词汇表

使用`torchtext`库从训练数据构建了词汇表。 `min_freq` 参数用于处理OOV词。

### 实验结果

#### 英语

| min_freq | len(vocab) | micro_avg_f1 |
| -------- | ---------- | ------------ |
| 1        | 23624      | 0.5667       |
| 2        | 11983      | 0.7720       |
| 3        | 8137       | 0.7468       |
| 4        | 6182       | 0.7242       |
| 5        | 4914       | 0.6960       |
| 6        | 4147       | 0.6715       |

#### 中文

| min_freq | len(vocab) | micro_avg_f1 |
| -------- | ---------- | ------------ |
| 1        | 1793       | 0.7871       |
| 2        | 1410       | 0.8379       |
| 3        | 1229       | 0.8475       |
| 4        | 1100       | 0.8549       |
| 5        | 994        | 0.8546       |
| 6        | 928        | 0.8535       |

## 维特比解码器

实现了维特比解码器，用于基于训练好的HMM参数解码给定句子的最可能标签序列。

## 结论

HMM模型在选择的参数和实验设置下，根据`min_freq`显示出不同的性能。维特比解码器成功预测了输入句子的标签序列。

本文档作为HMM模型实现、数据处理和英语、中文NER实验结果的综合概述。

# 条件随机场（CRF）命名实体识别（NER）报告

## 简介

本文档概述了使用条件随机场（CRF）进行命名实体识别（NER）的实现，涉及英语和中文两种语言。CRF模型使用了`pycrfsuite`和`sklearn_crfsuite`库。与之前的HMM模型相比，CRF模型具有更灵活的特征定义和更强大的学习能力。

## 模型参数

### CRF模型

使用`sklearn_crfsuite`库提供的CRF类来定义CRF模型的参数。其中的参数包括算法选择、正则化参数（`c1`和`c2`）、最大迭代次数等。

### 特征函数

定义了`word2features`函数，将单词转换为用于训练CRF模型的特征。这些特征包括单词的小写形式、后缀、是否大写等信息。此外，还定义了一系列“unigram”特征，用于捕捉相邻单词之间的关系。

### 标签函数

定义了`word2label`函数，用于从句子中提取标签。

### 提取特征和标签

使用`sent2features`和`sent2labels`函数将整个句子转换为特征序列和标签序列。

## 数据和实验

### 训练数据

使用`get_train_data`函数获取训练数据，其格式与HMM模型相同。

### CRF模型训练

使用`pycrfsuite.Trainer`进行CRF模型的训练，将特征序列和标签序列添加到训练器中。

## 评估

### 预测和评估

使用训练好的CRF模型对验证数据进行预测，并计算准确率。将预测结果与实际标签进行比较，输出预测文件以供进一步检查。

### 结果比较

对比了不同的特征设置对CRF模型性能的影响。通过改变unigram的数量和范围，观察了准确率的变化。

#### 结果

- 中文准确率约为0.9521。
- 英文为准确率提高至0.8702。

## 结论

CRF模型相对于HMM模型具有更强的学习能力，通过灵活定义特征，可以更好地捕捉单词之间的关系。实验结果表明，通过调整特征函数，可以提高模型的性能。